<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="dev log" />
<meta name="keywords" content="trickster" />

<title>trickster | Worker Queues</title>
<meta property="og:title" content="trickster | Worker Queues" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://trickster.github.io/posts/worker-queues/" />
<meta property="og:description" content="Different job queue systems" />
<meta property="og:image" content="" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Worker Queues" />
<meta name="twitter:description" content="Different job queue systems" />
<meta property="twitter:image" content="" />


    <link rel="alternate" type="application/rss+xml" title="trickster" href="https://trickster.github.io/ atom.xml">
    

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet"> 
    <!-- <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet"> -->

    <link rel="stylesheet" href="https://trickster.github.io/css/base.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"
        integrity="sha512-7x3zila4t2qNycrtZ31HO0NnJr8kg2VI67YLoRSyi9hGhRN66FHYWr7Axa9Y1J9tGYHVBPqIjSE1ogHrJTz51g=="
        crossorigin="anonymous"></script>
</head>

<body>
    <header>
        <a class="site-name" href="/">
            <h1>trickster</h1>
        </a>
        <div class="site-description">
            <p>notes</p>
        </div>
        <nav>
            <div class="links">
                
                
                <a 
                    href="https://trickster.github.io/ ">Home
                </a>
                
                
                <a 
                    href="https://trickster.github.io/posts/ ">Blog
                </a>
                
                
                <a 
                    href="https://trickster.github.io/tags/ ">Tags
                </a>
                
                
                <a 
                    href="https://trickster.github.io/projects/ ">Projects
                </a>
                
                
                <a 
                    href="https://trickster.github.io/contact/ ">Contact
                </a>
                
            </div>
        </nav>
    </header>
    <article>

<section class="post">
    <div class="post-header">
        <div class="meta">
            <div class="date">
                <span class="day">27</span>
                <span class="rest">May 2021</span>
            </div>
        </div>

        <div class="matter">
            <h1 class="title">Worker Queues</h1>
        </div>
    </div>
    <article>
        <p>Tried Beanstalkerd, for a job queue, realized the language support is not very good. But, I realized Redis has Lists. We can use them to push (from producer) and pop (worker/consumer)</p>
<p>Producer pushes</p>
<pre data-lang="sh" style="background-color:#151515;color:#e8e8d3;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; RPUSH list2 0
</span><span>(</span><span style="color:#ffb964;">integer</span><span>) 1
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; RPUSH list2 1
</span><span>(</span><span style="color:#ffb964;">integer</span><span>) 2
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; RPUSH list2 2
</span><span>(</span><span style="color:#ffb964;">integer</span><span>) 3
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; RPUSH list2 3
</span><span>(</span><span style="color:#ffb964;">integer</span><span>) 4
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; RPUSH list2 4
</span><span>(</span><span style="color:#ffb964;">integer</span><span>) 5
</span></code></pre>
<p>Consumer pulls from the queue</p>
<pre data-lang="sh" style="background-color:#151515;color:#e8e8d3;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; BLPOP list2 0
</span><span style="color:#ffb964;">1</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">list2</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">2</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">0</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; BLPOP list2 0
</span><span style="color:#ffb964;">1</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">list2</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">2</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">1</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; BLPOP list2 0
</span><span style="color:#ffb964;">1</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">list2</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">2</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">2</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; BLPOP list2 0
</span><span style="color:#ffb964;">1</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">list2</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">2</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">3</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">127.0.0.1:6379</span><span>&gt; BLPOP list2 0
</span><span style="color:#ffb964;">1</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">list2</span><span style="color:#556633;">&quot;
</span><span style="color:#ffb964;">2</span><span>) </span><span style="color:#556633;">&quot;</span><span style="color:#99ad6a;">4</span><span style="color:#556633;">&quot;
</span></code></pre>
<p>We can also push multiple items to the list, and have multiple consumers listening to the same list with no duplication. P.S. - &quot;B&quot; in &quot;BLPOP&quot; is blocking operation, waits for the message from the queue</p>

    </article>
</section>
</article>
    <footer>
        <div class="social">
            <ul>
                <li>
                    <a href="https://github.com" title="Github"><i data-feather="github"></i></a>
                </li>
                <li>
                    <a href="https://twitter.com" title="Twitter"><i data-feather="twitter"></i></a>
                </li>
                <li>
                    <a href="https://trickster.github.io/ atom.xml" title="trickster"><i
                            data-feather="rss"></i></a>
                </li>
            </ul>
        </div>
        <p>
            Â© trickster 2022<br>
            Powered by <a target="_blank" href="https://getzola.org/">Zola</a>
        </p>
    </footer>
    <noscript><img src="https://shynet.mrkaran.dev/ingress/315d76e3-3239-469c-96c5-95fdc568b64e/pixel.gif"></noscript>
    <script src="https://shynet.mrkaran.dev/ingress/315d76e3-3239-469c-96c5-95fdc568b64e/script.js"></script>
    <script>
        feather.replace();
    </script>
</body>

</html>